<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mythfall Loot Tracker</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <h1>ðŸ§­ Mythfall Loot Tracker</h1>
    <p>View dungeon drops and live drop rates â€” always available, even when the bot is offline.</p>
  </header>

  <main>
    <section id="dungeons">
      <!-- Dungeon sections will be inserted here -->
    </section>
  </main>

  <footer>
    <p>Built by Arpee for the Mythfall community</p>
  </footer>

  <script>
    const lootData = {
      "Pirate Cove": [
        "Cutlass",
        "Blunderbuss",
        "Captain's Hat",
        "Gunpowder Egg",
        "Captain's Cape",
        "Pirate Diary (Pg 1)",
        "Pirate Diary (Pg 2)"
      ],
      "Coolcrab Grotto": [
        "Coolcrab Shades",
        "Dancing Boots",
        "Wedding Band",
        "Tidal Egg",
        "Dance Notes (Pg 1)",
        "Dance Notes (Pg 2)"
      ],
      "Future Dungeons": [
        "Coming Soon..."
      ]
    };

    Promise.all([
      fetch('data/piratecove.json').then(res => res.json()).catch(() => ({})),
      fetch('data/coolcrabgrotto.json').then(res => res.json()).catch(() => ({}))
    ]).then(([pirateStats, crabStats]) => {
      const container = document.getElementById("dungeons");

      for (const [dungeon, drops] of Object.entries(lootData)) {
        const section = document.createElement("section");
        section.className = "dungeon";

        const title = document.createElement("h2");
        title.textContent = dungeon;
        section.appendChild(title);

        const list = document.createElement("ul");
        drops.forEach(drop => {
          let statText = "";

          if (dungeon === "Pirate Cove") {
            if (pirateStats[drop]) {
              const { count, rate: actualRate } = pirateStats[drop];
              statText = `Logged: ${count} (${actualRate}%)`;
            } else {
              statText = `Logged: 0 (0%) â€” unlogged`;
            }
          } else if (dungeon === "Coolcrab Grotto") {
            if (crabStats[drop]) {
              const { count, rate: actualRate } = crabStats[drop];
              statText = `Logged: ${count} (${actualRate}%)`;
            } else {
              statText = `Logged: 0 (0%) â€” unlogged`;
            }
          } else {
            statText = `â€” placeholder`;
          }

          list.innerHTML += `<li>${drop} <span class="rate">${statText}</span></li>`;
        });

        section.appendChild(list);
        container.appendChild(section);
      }
    });
  </script>
</body>
</html>
